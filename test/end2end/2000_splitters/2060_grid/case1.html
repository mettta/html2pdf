<!doctype html>
<html lang="">

<head>
  <meta charset="utf-8" />
  <meta name="keywords" content="HTML2PDF, end2end" />
  <meta name="description" content="HTML2PDF end2end test" />
  <title>Test page</title>
  <link rel="stylesheet" href="../../../shared/css/main.css">

  <script
    defer
    data-debug-mode="true"
    data-markup-debug-mode="true"
    data-print-height='600px'
    data-print-width='600px'
    data-print-left-margin= '50px'
    data-print-right-margin= '50px'
    data-print-top-margin= '50px'
    data-print-bottom-margin= '50px'
    data-print-font-size='16px'
    data-console-assert="true"

    data-forced-page-break-selectors=''
    data-page-break-after-selectors=''
    data-page-break-before-selectors=''

    data-no-break-selectors='.html2pdf4doc-no-break'
    data-no-hanging-selectors='.html2pdf4doc-no-hanging'
    src="../../../../dist/bundle.js"></script>
</head>
<style>
  .grid {
    display: grid;
    grid-template-columns: minmax(100px, min-content) minmax(0, 1fr);
    place-items: stretch stretch;
    place-content: stretch stretch;
    gap: 4px;
    background-color: rgba(0, 250, 250, 0.2);
    /* position: relative; */
    position: static; /* ⬅️ case 2 */
  }

  .grid-cell {}

  /*
    1.
    The case without explicit `grid-columns` crashed because cells were grouped
    only by grid-column-start; with auto, each cell opened a “new row,”
    and the splitter lost the actual breakdown.
    Now the row is determined by the vertical position of the element.
    2.
    Overflow with `position: static`:
    occurred due to offset relative to <body>: without relative context,
    offsetTop pointed to the entire document, and the entire grid was considered
    a single line. We temporarily move the container to `position: relative`,
    measure it, and then return the original inline value.
  */

  .col1 {
    /* grid-column: 1 / 2; */ /* ⬅️ case 1 */
  }

  .col2 {
    /* grid-column: 2 / 3; */ /* ⬅️ case 1 */
  }

  .grid-caption {
    grid-column: 1 / 3;
    font-weight: bold;
  }

  .content {
    /* content line height + gap = 30px */
    /* content line height = 1px*2 border + line-height 16px + 4*2 padding = 26px */
    box-sizing: border-box;
    border: 1px solid blue;
    background-color: rgba(0, 250, 250, 0.2);
    padding: 4px;
    min-height: 26px;
    font-size: 14px;
    line-height: 16px;
  }
</style>

<body>
  <!-- height:200px –> margin-bottom: 4px === gap: 4px; -->
  <!-- height:201px –> margin-bottom: 33px = 30px + (4-1) -->
  <div filler="red" style="height:200px"></div>

  <!-- W/o grid-column for col1/2 it does not work. -->
  <!-- W/o .grid {position: relative;} it works wrong. -->

  <div class="grid">
    <div class="grid-cell grid-caption" data-testid="L0">
      <div class="content">grid caption</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L1-1">
      <div class="content key">key 1</div>
    </div>
    <div class="grid-cell col2" data-testid="L1-2">
      <div class="content value">value 1</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L2-1">
      <div class="content key">key 2</div>
    </div>
    <div class="grid-cell col2" data-testid="L2-2">
      <div class="content value">value 2</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L3-1">
      <div class="content key">key 3</div>
    </div>
    <div class="grid-cell col2" data-testid="L3-2">
      <div class="content value">value 3</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L4-1">
      <div class="content key">key 4</div>
    </div>
    <div class="grid-cell col2" data-testid="L4-2">
      <div class="content value">value 4</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L5-1">
      <div class="content key">key 5</div>
    </div>
    <div class="grid-cell col2" data-testid="L5-2">
      <div class="content value">value 5</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L6-1">
      <div class="content key">key 6</div>
    </div>
    <div class="grid-cell col2" data-testid="L6-2">
      <div class="content value">value 6</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L7-1">
      <div class="content key">key 7</div>
    </div>
    <div class="grid-cell col2" data-testid="L7-2">
      <div class="content value">value 7</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L8-1">
      <div class="content key">key 8</div>
    </div>
    <div class="grid-cell col2" data-testid="L8-2">
      <div class="content value">value 8</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L9-1">
      <div class="content key">key 9</div>
    </div>
    <div class="grid-cell col2" data-testid="L9-2">
      <div class="content value">value 9</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L10-1">
      <div class="content key">key 10</div>
    </div>
    <div class="grid-cell col2" data-testid="L10-2">
      <div class="content value">value 10</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L11-1">
      <div class="content key">key 11</div>
    </div>
    <div class="grid-cell col2" data-testid="L11-2">
      <div class="content value">value 11</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L12-1">
      <div class="content key">key 12</div>
    </div>
    <div class="grid-cell col2" data-testid="L12-2">
      <div class="content value">value 12</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L13-1">
      <div class="content key">key 13</div>
    </div>
    <div class="grid-cell col2" data-testid="L13-2">
      <div class="content value">value 13</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L14-1">
      <div class="content key">key 14</div>
    </div>
    <div class="grid-cell col2" data-testid="L14-2">
      <div class="content value">value 14</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L15-1">
      <div class="content key">key 15</div>
    </div>
    <div class="grid-cell col2" data-testid="L15-2">
      <div class="content value">value 15</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L16-1">
      <div class="content key">key 16</div>
    </div>
    <div class="grid-cell col2" data-testid="L16-2">
      <div class="content value">value 16</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L17-1">
      <div class="content key">key 17</div>
    </div>
    <div class="grid-cell col2" data-testid="L17-2">
      <div class="content value">value 17</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L18-1">
      <div class="content key">key 18</div>
    </div>
    <div class="grid-cell col2" data-testid="L18-2">
      <div class="content value">value 18</div>
    </div>
    <!-- - -->
    <div class="grid-cell col1" data-testid="L19-1">
      <div class="content key">key 19</div>
    </div>
    <div class="grid-cell col2" data-testid="L19-2">
      <div class="content value">value 19</div>
    </div>
    <!-- - -->
  </div>

  <div data-testid="closer" filler="red" style="height:1px"></div>
</body>

</html>
